<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Gym Logbuch</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 30px;
        }
        h2 {
            margin-top: 50px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            border: 1px solid black;
            padding: 6px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        input {
            width: 90%;
            border: none;
            text-align: center;
        }
        .header-info {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

<h1>Workout Logbuch</h1>

<!-- PUSH FB -->
<h2 id="pushHeader">PushFB</h2>
<table id="pushTable">
    <tr>
        <th rowspan="2">Übung</th>
        <th colspan="2">Aufwärmsatz</th>
        <th colspan="2">Arbeitssatz 1</th>
        <th colspan="2">Arbeitssatz 2</th>
    </tr>
    <tr>
        <th>Gewicht</th>
        <th>Wdh</th>
        <th>Gewicht</th>
        <th>Wdh</th>
        <th>Gewicht</th>
        <th>Wdh</th>
    </tr>
    <!-- 8 Übungszeilen -->
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
</table>

<!-- PULL FB -->
<h2 id="pullHeader">PullFB</h2>
<table id="pullTable">
    <tr>
        <th rowspan="2">Übung</th>
        <th colspan="2">Aufwärmsatz</th>
        <th colspan="2">Arbeitssatz 1</th>
        <th colspan="2">Arbeitssatz 2</th>
    </tr>
    <tr>
        <th>Gewicht</th>
        <th>Wdh</th>
        <th>Gewicht</th>
        <th>Wdh</th>
        <th>Gewicht</th>
        <th>Wdh</th>
    </tr>
    <!-- 8 Übungszeilen -->
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
    <tr><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td><td><input></td></tr>
</table>

<button onclick="saveWorkout()">Training speichern</button>

<h2>Gespeicherte Trainings-Tage</h2>
<div id="history"></div>

<script>
/* Tabellen initial verstecken */
document.getElementById("pushTable").style.display = "none";
document.getElementById("pushHeader").style.display = "none";
document.getElementById("pullTable").style.display = "none";
document.getElementById("pullHeader").style.display = "none";

function saveWorkout() {
    let today = new Date();
    let formattedDate = today.getDate().toString().padStart(2,'0') + '.' +
                        (today.getMonth() + 1).toString().padStart(2,'0') + '.' +
                        today.getFullYear();

    let workout = { date: formattedDate, push: [], pull: [] };

    // PUSH Tabelle auslesen
    let pushRows = document.querySelectorAll("#pushTable tr");
    pushRows.forEach((row,index)=>{
        if(index>1){
            let inputs = row.querySelectorAll("input");
            if(inputs.length>0){
                workout.push.push([...inputs].map(input=>input.value));
            }
        }
    });

    // PULL Tabelle auslesen
    let pullRows = document.querySelectorAll("#pullTable tr");
    pullRows.forEach((row,index)=>{
        if(index>1){
            let inputs = row.querySelectorAll("input");
            if(inputs.length>0){
                workout.pull.push([...inputs].map(input=>input.value));
            }
        }
    });

    let history = JSON.parse(localStorage.getItem("workouts")) || [];
    history.push(workout);
    localStorage.setItem("workouts", JSON.stringify(history));

    displayHistory();
}

/* Lädt das letzte Workout in die Tabelle(n), ohne das Display zu ändern */
function loadLastWorkout(){
    let history = JSON.parse(localStorage.getItem("workouts")) || [];
    if(history.length===0) return;

    let lastWorkout = history[history.length-1];

    // PUSH Tabelle
    let pushRows = document.querySelectorAll("#pushTable tr");
    pushRows.forEach((row,index)=>{
        if(index>1 && lastWorkout.push[index-2]){
            let inputs = row.querySelectorAll("input");
            lastWorkout.push[index-2].forEach((val,i)=>inputs[i].value=val);
        }
    });

    // PULL Tabelle
    let pullRows = document.querySelectorAll("#pullTable tr");
    pullRows.forEach((row,index)=>{
        if(index>1 && lastWorkout.pull[index-2]){
            let inputs = row.querySelectorAll("input");
            lastWorkout.pull[index-2].forEach((val,i)=>inputs[i].value=val);
        }
    });
}

/* Historie anzeigen */
function displayHistory(){
    let history = JSON.parse(localStorage.getItem("workouts")) || [];
    let container = document.getElementById("history");
    container.innerHTML = "";

    history.slice().reverse().forEach(workout=>{
        let wrapper = document.createElement("div");
        wrapper.style.border = "1px solid black";
        wrapper.style.marginBottom = "15px";
        wrapper.style.padding = "10px";

        let header = document.createElement("div");
        header.style.cursor = "pointer";
        header.style.fontWeight = "bold";
        header.innerText = workout.date + " ▼";

        let content = document.createElement("div");
        content.style.display = "none";
        content.style.marginTop = "10px";

        // PUSH
        content.innerHTML += "<h4>PushFB</h4>";
        workout.push.forEach(row=>{
            if(row[0]!==""){
                content.innerHTML += `<div style="margin-bottom:8px;">
                    <strong>${row[0]}</strong><br>
                    Aufwärm: ${row[1]}kg × ${row[2]}<br>
                    Satz 1: ${row[3]}kg × ${row[4]}<br>
                    Satz 2: ${row[5]}kg × ${row[6]}
                </div>`;
            }
        });

        // PULL
        content.innerHTML += "<h4>PullFB</h4>";
        workout.pull.forEach(row=>{
            if(row[0]!==""){
                content.innerHTML += `<div style="margin-bottom:8px;">
                    <strong>${row[0]}</strong><br>
                    Aufwärm: ${row[1]}kg × ${row[2]}<br>
                    Satz 1: ${row[3]}kg × ${row[4]}<br>
                    Satz 2: ${row[5]}kg × ${row[6]}
                </div>`;
            }
        });

        header.onclick = ()=>{ content.style.display = content.style.display==="none" ? "block":"none"; };
        wrapper.appendChild(header);
        wrapper.appendChild(content);
        container.appendChild(wrapper);
    });
}

/* Zeigt nur die Tabelle für den heutigen Tag */
function showTodayWorkout() {
    let startDate = new Date(2026, 1, 16); // Montag, Startdatum
    let today = new Date();
    startDate.setHours(0,0,0,0);
    today.setHours(0,0,0,0);
    let diffDays = Math.floor((today - startDate) / (1000*60*60*24));
    let cycleDay = diffDays % 3;

    // Alle Tabellen ausblenden
    document.getElementById("pushHeader").style.display = "none";
    document.getElementById("pushTable").style.display = "none";
    document.getElementById("pullHeader").style.display = "none";
    document.getElementById("pullTable").style.display = "none";

    if(cycleDay === 0){
        document.getElementById("pushHeader").style.display = "block";
        document.getElementById("pushTable").style.display = "table";
    } 
    else if(cycleDay === 1){
        document.getElementById("pullHeader").style.display = "block";
        document.getElementById("pullTable").style.display = "table";
    } 
    else{
        alert("Heute ist Restday");
    }
}

/* Lade Trainings-Historie + letztes Workout + heute Tabelle */
displayHistory();
loadLastWorkout();
showTodayWorkout();
</script>

</body>
</html>
